     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_vsprintf
     7 00000000                                 	EXTERN	_api_putstr0
     8 00000000                                 	EXTERN	__alloca
     9 00000000                                 	EXTERN	_api_getlang
    10 00000000                                 	EXTERN	_api_cmdline
    11 00000000                                 	EXTERN	_api_end
    12 00000000                                 	EXTERN	_strtol
    13 00000000                                 	EXTERN	_api_openwin
    14 00000000                                 	EXTERN	_api_boxfilwin
    15 00000000                                 	EXTERN	_api_fopen
    16 00000000                                 	EXTERN	_api_fsize
    17 00000000                                 	EXTERN	_api_fread
    18 00000000                                 	EXTERN	_api_fclose
    19 00000000                                 	EXTERN	_api_getkey
    20 00000000                                 	EXTERN	_api_refreshwin
    21 00000000                                 	EXTERN	_api_putstrwin
    22 00000000                                 [FILE "tview.ca"]
    23                                          [SECTION .text]
    24 00000000                                 	GLOBAL	_printf
    25 00000000                                 _printf:
    26 00000000 55                              	PUSH	EBP
    27 00000001 89 E5                           	MOV	EBP,ESP
    28 00000003 56                              	PUSH	ESI
    29 00000004 53                              	PUSH	EBX
    30 00000005 81 EC 000003F0                  	SUB	ESP,1008
    31 0000000B 8D 45 0C                        	LEA	EAX,DWORD [12+EBP]
    32 0000000E 8D 9D FFFFFC08                  	LEA	EBX,DWORD [-1016+EBP]
    33 00000014 50                              	PUSH	EAX
    34 00000015 FF 75 08                        	PUSH	DWORD [8+EBP]
    35 00000018 53                              	PUSH	EBX
    36 00000019 E8 [00000000]                   	CALL	_vsprintf
    37 0000001E 53                              	PUSH	EBX
    38 0000001F 89 C6                           	MOV	ESI,EAX
    39 00000021 E8 [00000000]                   	CALL	_api_putstr0
    40 00000026 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    41 00000029 89 F0                           	MOV	EAX,ESI
    42 0000002B 5B                              	POP	EBX
    43 0000002C 5E                              	POP	ESI
    44 0000002D 5D                              	POP	EBP
    45 0000002E C3                              	RET
    46                                          [SECTION .data]
    47 00000000                                 LC0:
    48 00000000 20 3E 74 76 69 65 77 20 66 69   	DB	" >tview file [-w30 -h10 -t4]",0x0A,0x00
       0000000A 6C 65 20 5B 2D 77 33 30 20 2D 
       00000014 68 31 30 20 2D 74 34 5D 0A 00 
    49 0000001E                                 LC1:
    50 0000001E 66 69 6C 65 20 6F 70 65 6E 20   	DB	"file open error.",0x0A,0x00
       00000028 65 72 72 6F 72 2E 0A 00 
    51                                          [SECTION .text]
    52 0000002F                                 	GLOBAL	_CHNMain
    53 0000002F                                 _CHNMain:
    54 0000002F 55                              	PUSH	EBP
    55 00000030 B8 000F9448                     	MOV	EAX,1021000
    56 00000035 89 E5                           	MOV	EBP,ESP
    57 00000037 57                              	PUSH	EDI
    58 00000038 56                              	PUSH	ESI
    59 00000039 31 FF                           	XOR	EDI,EDI
    60 0000003B 53                              	PUSH	EBX
    61 0000003C 8D 9D FFF06BD4                  	LEA	EBX,DWORD [-1020972+EBP]
    62 00000042 E8 [00000000]                   	CALL	__alloca
    63 00000047 C7 85 FFF06BCC 0000001E         	MOV	DWORD [-1020980+EBP],30
    64 00000051 C7 85 FFF06BC8 0000000A         	MOV	DWORD [-1020984+EBP],10
    65 0000005B C7 85 FFF06BC4 00000004         	MOV	DWORD [-1020988+EBP],4
    66 00000065 C7 85 FFF06BC0 00000001         	MOV	DWORD [-1020992+EBP],1
    67 0000006F C7 85 FFF06BBC 00000001         	MOV	DWORD [-1020996+EBP],1
    68 00000079 E8 [00000000]                   	CALL	_api_getlang
    69 0000007E 6A 1E                           	PUSH	30
    70 00000080 53                              	PUSH	EBX
    71 00000081 89 85 FFF06BB4                  	MOV	DWORD [-1021004+EBP],EAX
    72 00000087 C7 85 FFF06BB0 00000000         	MOV	DWORD [-1021008+EBP],0
    73 00000091 C7 85 FFF06BAC 00000000         	MOV	DWORD [-1021012+EBP],0
    74 0000009B E8 [00000000]                   	CALL	_api_cmdline
    75 000000A0 89 D9                           	MOV	ECX,EBX
    76 000000A2 5E                              	POP	ESI
    77 000000A3 89 9D FFF06BD0                  	MOV	DWORD [-1020976+EBP],EBX
    78 000000A9 58                              	POP	EAX
    79 000000AA 80 BD FFF06BD4 20               	CMP	BYTE [-1020972+EBP],32
    80 000000B1 7E 19                           	JLE	L96
    81 000000B3 8D 95 FFF06BD5                  	LEA	EDX,DWORD [-1020971+EBP]
    82 000000B9                                 L7:
    83 000000B9 89 D0                           	MOV	EAX,EDX
    84 000000BB 89 95 FFF06BD0                  	MOV	DWORD [-1020976+EBP],EDX
    85 000000C1 8D 51 02                        	LEA	EDX,DWORD [2+ECX]
    86 000000C4 89 C1                           	MOV	ECX,EAX
    87 000000C6 80 7A FF 20                     	CMP	BYTE [-1+EDX],32
    88 000000CA 7F ED                           	JG	L7
    89 000000CC                                 L96:
    90 000000CC 8B 85 FFF06BD0                  	MOV	EAX,DWORD [-1020976+EBP]
    91 000000D2 80 38 00                        	CMP	BYTE [EAX],0
    92 000000D5 0F 84 0000012D                  	JE	L98
    93 000000DB FF B5 FFF06BD0                  	PUSH	DWORD [-1020976+EBP]
    94 000000E1 E8 00000405                     	CALL	_skipspace
    95 000000E6 5B                              	POP	EBX
    96 000000E7 89 C2                           	MOV	EDX,EAX
    97 000000E9 89 85 FFF06BD0                  	MOV	DWORD [-1020976+EBP],EAX
    98 000000EF 8A 08                           	MOV	CL,BYTE [EAX]
    99 000000F1 80 F9 2D                        	CMP	CL,45
   100 000000F4 74 40                           	JE	L109
   101 000000F6 85 FF                           	TEST	EDI,EDI
   102 000000F8 74 12                           	JE	L110
   103 000000FA                                 L24:
   104 000000FA 68 [00000000]                   	PUSH	LC0
   105 000000FF E8 [00000000]                   	CALL	_api_putstr0
   106 00000104 E8 [00000000]                   	CALL	_api_end
   107 00000109 5E                              	POP	ESI
   108 0000010A EB C0                           	JMP	L96
   109 0000010C                                 L110:
   110 0000010C 89 C7                           	MOV	EDI,EAX
   111 0000010E 80 F9 20                        	CMP	CL,32
   112 00000111 7E 15                           	JLE	L100
   113 00000113                                 L31:
   114 00000113 8B 95 FFF06BD0                  	MOV	EDX,DWORD [-1020976+EBP]
   115 00000119 8D 42 01                        	LEA	EAX,DWORD [1+EDX]
   116 0000011C 89 85 FFF06BD0                  	MOV	DWORD [-1020976+EBP],EAX
   117 00000122 80 7A 01 20                     	CMP	BYTE [1+EDX],32
   118 00000126 7F EB                           	JG	L31
   119 00000128                                 L100:
   120 00000128 8B 85 FFF06BD0                  	MOV	EAX,DWORD [-1020976+EBP]
   121 0000012E 89 85 FFF06BAC                  	MOV	DWORD [-1021012+EBP],EAX
   122 00000134 EB 96                           	JMP	L96
   123 00000136                                 L109:
   124 00000136 8A 40 01                        	MOV	AL,BYTE [1+EAX]
   125 00000139 3C 77                           	CMP	AL,119
   126 0000013B 0F 84 00000081                  	JE	L111
   127 00000141 3C 68                           	CMP	AL,104
   128 00000143 74 36                           	JE	L112
   129 00000145 3C 74                           	CMP	AL,116
   130 00000147 75 B1                           	JNE	L24
   131 00000149 6A 00                           	PUSH	0
   132 0000014B 8D 85 FFF06BD0                  	LEA	EAX,DWORD [-1020976+EBP]
   133 00000151 50                              	PUSH	EAX
   134 00000152 8D 42 02                        	LEA	EAX,DWORD [2+EDX]
   135 00000155 50                              	PUSH	EAX
   136 00000156 E8 [00000000]                   	CALL	_strtol
   137 0000015B 83 C4 0C                        	ADD	ESP,12
   138 0000015E 85 C0                           	TEST	EAX,EAX
   139 00000160 89 85 FFF06BC4                  	MOV	DWORD [-1020988+EBP],EAX
   140 00000166 0F 8F FFFFFF60                  	JG	L96
   141 0000016C C7 85 FFF06BC4 00000004         	MOV	DWORD [-1020988+EBP],4
   142 00000176 E9 FFFFFF51                     	JMP	L96
   143 0000017B                                 L112:
   144 0000017B 6A 00                           	PUSH	0
   145 0000017D 8D 85 FFF06BD0                  	LEA	EAX,DWORD [-1020976+EBP]
   146 00000183 50                              	PUSH	EAX
   147 00000184 8D 42 02                        	LEA	EAX,DWORD [2+EDX]
   148 00000187 50                              	PUSH	EAX
   149 00000188 E8 [00000000]                   	CALL	_strtol
   150 0000018D 83 C4 0C                        	ADD	ESP,12
   151 00000190 85 C0                           	TEST	EAX,EAX
   152 00000192 89 85 FFF06BC8                  	MOV	DWORD [-1020984+EBP],EAX
   153 00000198 7E 1C                           	JLE	L113
   154 0000019A                                 L18:
   155 0000019A 83 BD FFF06BC8 2D               	CMP	DWORD [-1020984+EBP],45
   156 000001A1 0F 8E FFFFFF25                  	JLE	L96
   157 000001A7 C7 85 FFF06BC8 0000002D         	MOV	DWORD [-1020984+EBP],45
   158 000001B1 E9 FFFFFF16                     	JMP	L96
   159 000001B6                                 L113:
   160 000001B6 C7 85 FFF06BC8 00000001         	MOV	DWORD [-1020984+EBP],1
   161 000001C0 EB D8                           	JMP	L18
   162 000001C2                                 L111:
   163 000001C2 6A 00                           	PUSH	0
   164 000001C4 8D 85 FFF06BD0                  	LEA	EAX,DWORD [-1020976+EBP]
   165 000001CA 50                              	PUSH	EAX
   166 000001CB 8D 42 02                        	LEA	EAX,DWORD [2+EDX]
   167 000001CE 50                              	PUSH	EAX
   168 000001CF E8 [00000000]                   	CALL	_strtol
   169 000001D4 83 C4 0C                        	ADD	ESP,12
   170 000001D7 83 F8 13                        	CMP	EAX,19
   171 000001DA 89 85 FFF06BCC                  	MOV	DWORD [-1020980+EBP],EAX
   172 000001E0 7F 0A                           	JG	L14
   173 000001E2 C7 85 FFF06BCC 00000014         	MOV	DWORD [-1020980+EBP],20
   174 000001EC                                 L14:
   175 000001EC 83 BD FFF06BCC 7E               	CMP	DWORD [-1020980+EBP],126
   176 000001F3 0F 8E FFFFFED3                  	JLE	L96
   177 000001F9 C7 85 FFF06BCC 0000007E         	MOV	DWORD [-1020980+EBP],126
   178 00000203 E9 FFFFFEC4                     	JMP	L96
   179 00000208                                 L98:
   180 00000208 85 FF                           	TEST	EDI,EDI
   181 0000020A 0F 84 FFFFFEEA                  	JE	L24
   182 00000210 8B B5 FFF06BC8                  	MOV	ESI,DWORD [-1020984+EBP]
   183 00000216 8D 85 FFF06BD4                  	LEA	EAX,DWORD [-1020972+EBP]
   184 0000021C C1 E6 04                        	SAL	ESI,4
   185 0000021F 8B 9D FFF06BCC                  	MOV	EBX,DWORD [-1020980+EBP]
   186 00000225 C1 E3 03                        	SAL	EBX,3
   187 00000228 50                              	PUSH	EAX
   188 00000229 6A FF                           	PUSH	-1
   189 0000022B 8D 46 25                        	LEA	EAX,DWORD [37+ESI]
   190 0000022E 50                              	PUSH	EAX
   191 0000022F 83 C6 1E                        	ADD	ESI,30
   192 00000232 8D 43 10                        	LEA	EAX,DWORD [16+EBX]
   193 00000235 83 C3 09                        	ADD	EBX,9
   194 00000238 50                              	PUSH	EAX
   195 00000239 8D 85 FFF42BF4                  	LEA	EAX,DWORD [-775180+EBP]
   196 0000023F 50                              	PUSH	EAX
   197 00000240 E8 [00000000]                   	CALL	_api_openwin
   198 00000245 6A 07                           	PUSH	7
   199 00000247 56                              	PUSH	ESI
   200 00000248 53                              	PUSH	EBX
   201 00000249 89 85 FFF06BB8                  	MOV	DWORD [-1021000+EBP],EAX
   202 0000024F 6A 1B                           	PUSH	27
   203 00000251 6A 06                           	PUSH	6
   204 00000253 50                              	PUSH	EAX
   205 00000254 E8 [00000000]                   	CALL	_api_boxfilwin
   206 00000259 83 C4 2C                        	ADD	ESP,44
   207 0000025C 8B 8D FFF06BAC                  	MOV	ECX,DWORD [-1021012+EBP]
   208 00000262 C6 01 00                        	MOV	BYTE [ECX],0
   209 00000265 57                              	PUSH	EDI
   210 00000266 E8 [00000000]                   	CALL	_api_fopen
   211 0000026B 5B                              	POP	EBX
   212 0000026C 89 C7                           	MOV	EDI,EAX
   213 0000026E 85 C0                           	TEST	EAX,EAX
   214 00000270 75 10                           	JNE	L34
   215 00000272 68 [0000001E]                   	PUSH	LC1
   216 00000277 E8 [00000000]                   	CALL	_api_putstr0
   217 0000027C E8 [00000000]                   	CALL	_api_end
   218 00000281 59                              	POP	ECX
   219 00000282                                 L34:
   220 00000282 6A 00                           	PUSH	0
   221 00000284 57                              	PUSH	EDI
   222 00000285 E8 [00000000]                   	CALL	_api_fsize
   223 0000028A 89 C6                           	MOV	ESI,EAX
   224 0000028C 58                              	POP	EAX
   225 0000028D 5A                              	POP	EDX
   226 0000028E 81 FE 0003BFFE                  	CMP	ESI,245758
   227 00000294 7E 05                           	JLE	L35
   228 00000296 BE 0003BFFE                     	MOV	ESI,245758
   229 0000029B                                 L35:
   230 0000029B 57                              	PUSH	EDI
   231 0000029C 8D 9D FFF06BF5                  	LEA	EBX,DWORD [-1020939+EBP]
   232 000002A2 56                              	PUSH	ESI
   233 000002A3 53                              	PUSH	EBX
   234 000002A4 C6 85 FFF06BF4 0A               	MOV	BYTE [-1020940+EBP],10
   235 000002AB E8 [00000000]                   	CALL	_api_fread
   236 000002B0 57                              	PUSH	EDI
   237 000002B1 89 DF                           	MOV	EDI,EBX
   238 000002B3 E8 [00000000]                   	CALL	_api_fclose
   239 000002B8 C6 84 35 FFF06BF5 00            	MOV	BYTE [-1020939+EBP+ESI*1],0
   240 000002C0 83 C4 10                        	ADD	ESP,16
   241 000002C3 89 9D FFF06BD0                  	MOV	DWORD [-1020976+EBP],EBX
   242 000002C9 80 BD FFF06BF5 00               	CMP	BYTE [-1020939+EBP],0
   243 000002D0 74 24                           	JE	L102
   244 000002D2                                 L41:
   245 000002D2 8B 85 FFF06BD0                  	MOV	EAX,DWORD [-1020976+EBP]
   246 000002D8 8A 00                           	MOV	AL,BYTE [EAX]
   247 000002DA 3C 0D                           	CMP	AL,13
   248 000002DC 74 03                           	JE	L38
   249 000002DE 88 07                           	MOV	BYTE [EDI],AL
   250 000002E0 47                              	INC	EDI
   251 000002E1                                 L38:
   252 000002E1 8B 95 FFF06BD0                  	MOV	EDX,DWORD [-1020976+EBP]
   253 000002E7 8D 42 01                        	LEA	EAX,DWORD [1+EDX]
   254 000002EA 89 85 FFF06BD0                  	MOV	DWORD [-1020976+EBP],EAX
   255 000002F0 80 7A 01 00                     	CMP	BYTE [1+EDX],0
   256 000002F4 75 DC                           	JNE	L41
   257 000002F6                                 L102:
   258 000002F6 8D 85 FFF06BF5                  	LEA	EAX,DWORD [-1020939+EBP]
   259 000002FC C6 07 00                        	MOV	BYTE [EDI],0
   260 000002FF 89 85 FFF06BD0                  	MOV	DWORD [-1020976+EBP],EAX
   261 00000305                                 L42:
   262 00000305 FF B5 FFF06BB4                  	PUSH	DWORD [-1021004+EBP]
   263 0000030B FF B5 FFF06BC4                  	PUSH	DWORD [-1020988+EBP]
   264 00000311 FF B5 FFF06BD0                  	PUSH	DWORD [-1020976+EBP]
   265 00000317 FF B5 FFF06BB0                  	PUSH	DWORD [-1021008+EBP]
   266 0000031D FF B5 FFF06BC8                  	PUSH	DWORD [-1020984+EBP]
   267 00000323 FF B5 FFF06BCC                  	PUSH	DWORD [-1020980+EBP]
   268 00000329 FF B5 FFF06BB8                  	PUSH	DWORD [-1021000+EBP]
   269 0000032F E8 000001CC                     	CALL	_textview
   270 00000334 6A 01                           	PUSH	1
   271 00000336 E8 [00000000]                   	CALL	_api_getkey
   272 0000033B 83 C4 20                        	ADD	ESP,32
   273 0000033E 89 C7                           	MOV	EDI,EAX
   274 00000340 83 F8 51                        	CMP	EAX,81
   275 00000343 0F 84 00000198                  	JE	L46
   276 00000349 83 F8 71                        	CMP	EAX,113
   277 0000034C 0F 84 0000018F                  	JE	L46
   278 00000352                                 L45:
   279 00000352 8D 4F BF                        	LEA	ECX,DWORD [-65+EDI]
   280 00000355 83 F9 05                        	CMP	ECX,5
   281 00000358 77 10                           	JA	L47
   282 0000035A C7 85 FFF06BC0 00000001         	MOV	DWORD [-1020992+EBP],1
   283 00000364 D3 A5 FFF06BC0                  	SAL	DWORD [-1020992+EBP],CL
   284 0000036A                                 L47:
   285 0000036A 8D 4F 9F                        	LEA	ECX,DWORD [-97+EDI]
   286 0000036D 83 F9 05                        	CMP	ECX,5
   287 00000370 77 10                           	JA	L48
   288 00000372 C7 85 FFF06BBC 00000001         	MOV	DWORD [-1020996+EBP],1
   289 0000037C D3 A5 FFF06BBC                  	SAL	DWORD [-1020996+EBP],CL
   290 00000382                                 L48:
   291 00000382 83 FF 3C                        	CMP	EDI,60
   292 00000385 0F 84 0000012E                  	JE	L114
   293 0000038B                                 L49:
   294 0000038B 83 FF 3E                        	CMP	EDI,62
   295 0000038E 0F 84 0000010A                  	JE	L115
   296 00000394                                 L50:
   297 00000394 83 FF 34                        	CMP	EDI,52
   298 00000397 0F 84 000000D5                  	JE	L52
   299 0000039D                                 L51:
   300 0000039D 83 FF 36                        	CMP	EDI,54
   301 000003A0 0F 84 000000AE                  	JE	L58
   302 000003A6                                 L57:
   303 000003A6 83 FF 38                        	CMP	EDI,56
   304 000003A9 74 52                           	JE	L63
   305 000003AB                                 L62:
   306 000003AB 83 FF 32                        	CMP	EDI,50
   307 000003AE                                 L108:
   308 000003AE 0F 85 FFFFFF51                  	JNE	L42
   309 000003B4 31 F6                           	XOR	ESI,ESI
   310 000003B6 3B B5 FFF06BBC                  	CMP	ESI,DWORD [-1020996+EBP]
   311 000003BC 7D 32                           	JGE	L83
   312 000003BE                                 L93:
   313 000003BE 8B BD FFF06BD0                  	MOV	EDI,DWORD [-1020976+EBP]
   314 000003C4 8A 07                           	MOV	AL,BYTE [EDI]
   315 000003C6 84 C0                           	TEST	AL,AL
   316 000003C8 74 0F                           	JE	L87
   317 000003CA 3C 0A                           	CMP	AL,10
   318 000003CC 74 0B                           	JE	L87
   319 000003CE                                 L91:
   320 000003CE 47                              	INC	EDI
   321 000003CF 8A 07                           	MOV	AL,BYTE [EDI]
   322 000003D1 84 C0                           	TEST	AL,AL
   323 000003D3 74 04                           	JE	L87
   324 000003D5 3C 0A                           	CMP	AL,10
   325 000003D7 75 F5                           	JNE	L91
   326 000003D9                                 L87:
   327 000003D9 80 3F 00                        	CMP	BYTE [EDI],0
   328 000003DC 74 12                           	JE	L83
   329 000003DE 8D 47 01                        	LEA	EAX,DWORD [1+EDI]
   330 000003E1 46                              	INC	ESI
   331 000003E2 89 85 FFF06BD0                  	MOV	DWORD [-1020976+EBP],EAX
   332 000003E8 3B B5 FFF06BBC                  	CMP	ESI,DWORD [-1020996+EBP]
   333 000003EE 7C CE                           	JL	L93
   334 000003F0                                 L83:
   335 000003F0 6A 00                           	PUSH	0
   336 000003F2 E8 [00000000]                   	CALL	_api_getkey
   337 000003F7 5A                              	POP	EDX
   338 000003F8 83 F8 32                        	CMP	EAX,50
   339 000003FB EB B1                           	JMP	L108
   340 000003FD                                 L63:
   341 000003FD 31 F6                           	XOR	ESI,ESI
   342 000003FF 3B B5 FFF06BBC                  	CMP	ESI,DWORD [-1020996+EBP]
   343 00000405 7D 3B                           	JGE	L67
   344 00000407                                 L76:
   345 00000407 8D 85 FFF06BF5                  	LEA	EAX,DWORD [-1020939+EBP]
   346 0000040D 8B 95 FFF06BD0                  	MOV	EDX,DWORD [-1020976+EBP]
   347 00000413 39 C2                           	CMP	EDX,EAX
   348 00000415 74 2B                           	JE	L67
   349 00000417 8D 42 FF                        	LEA	EAX,DWORD [-1+EDX]
   350 0000041A 89 85 FFF06BD0                  	MOV	DWORD [-1020976+EBP],EAX
   351 00000420 80 78 FF 0A                     	CMP	BYTE [-1+EAX],10
   352 00000424 74 13                           	JE	L105
   353 00000426                                 L75:
   354 00000426 8B 85 FFF06BD0                  	MOV	EAX,DWORD [-1020976+EBP]
   355 0000042C 48                              	DEC	EAX
   356 0000042D 89 85 FFF06BD0                  	MOV	DWORD [-1020976+EBP],EAX
   357 00000433 80 78 FF 0A                     	CMP	BYTE [-1+EAX],10
   358 00000437 75 ED                           	JNE	L75
   359 00000439                                 L105:
   360 00000439 46                              	INC	ESI
   361 0000043A 3B B5 FFF06BBC                  	CMP	ESI,DWORD [-1020996+EBP]
   362 00000440 7C C5                           	JL	L76
   363 00000442                                 L67:
   364 00000442 6A 00                           	PUSH	0
   365 00000444 E8 [00000000]                   	CALL	_api_getkey
   366 00000449 59                              	POP	ECX
   367 0000044A 83 F8 38                        	CMP	EAX,56
   368 0000044D 74 AE                           	JE	L63
   369 0000044F E9 FFFFFF57                     	JMP	L62
   370 00000454                                 L58:
   371 00000454 8B 8D FFF06BC0                  	MOV	ECX,DWORD [-1020992+EBP]
   372 0000045A 6A 00                           	PUSH	0
   373 0000045C 01 8D FFF06BB0                  	ADD	DWORD [-1021008+EBP],ECX
   374 00000462 E8 [00000000]                   	CALL	_api_getkey
   375 00000467 83 F8 36                        	CMP	EAX,54
   376 0000046A 5B                              	POP	EBX
   377 0000046B 74 E7                           	JE	L58
   378 0000046D E9 FFFFFF34                     	JMP	L57
   379 00000472                                 L52:
   380 00000472 8B 85 FFF06BC0                  	MOV	EAX,DWORD [-1020992+EBP]
   381 00000478 29 85 FFF06BB0                  	SUB	DWORD [-1021008+EBP],EAX
   382 0000047E 78 12                           	JS	L116
   383 00000480                                 L55:
   384 00000480 6A 00                           	PUSH	0
   385 00000482 E8 [00000000]                   	CALL	_api_getkey
   386 00000487 5E                              	POP	ESI
   387 00000488 83 F8 34                        	CMP	EAX,52
   388 0000048B 74 E5                           	JE	L52
   389 0000048D E9 FFFFFF0B                     	JMP	L51
   390 00000492                                 L116:
   391 00000492 C7 85 FFF06BB0 00000000         	MOV	DWORD [-1021008+EBP],0
   392 0000049C EB E2                           	JMP	L55
   393 0000049E                                 L115:
   394 0000049E 81 BD FFF06BC4 000000FF         	CMP	DWORD [-1020988+EBP],255
   395 000004A8 0F 8F FFFFFEE6                  	JG	L50
   396 000004AE D1 A5 FFF06BC4                  	SAL	DWORD [-1020988+EBP],1
   397 000004B4 E9 FFFFFEDB                     	JMP	L50
   398 000004B9                                 L114:
   399 000004B9 83 BD FFF06BC4 01               	CMP	DWORD [-1020988+EBP],1
   400 000004C0 0F 8E FFFFFEC5                  	JLE	L49
   401 000004C6 8B 85 FFF06BC4                  	MOV	EAX,DWORD [-1020988+EBP]
   402 000004CC BA 00000002                     	MOV	EDX,2
   403 000004D1 89 D1                           	MOV	ECX,EDX
   404 000004D3 99                              	CDQ
   405 000004D4 F7 F9                           	IDIV	ECX
   406 000004D6 89 85 FFF06BC4                  	MOV	DWORD [-1020988+EBP],EAX
   407 000004DC E9 FFFFFEAA                     	JMP	L49
   408 000004E1                                 L46:
   409 000004E1 E8 [00000000]                   	CALL	_api_end
   410 000004E6 E9 FFFFFE67                     	JMP	L45
   411 000004EB                                 	GLOBAL	_skipspace
   412 000004EB                                 _skipspace:
   413 000004EB 55                              	PUSH	EBP
   414 000004EC 89 E5                           	MOV	EBP,ESP
   415 000004EE 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   416 000004F1 80 38 20                        	CMP	BYTE [EAX],32
   417 000004F4 74 02                           	JE	L122
   418 000004F6                                 L124:
   419 000004F6 5D                              	POP	EBP
   420 000004F7 C3                              	RET
   421 000004F8                                 L122:
   422 000004F8 40                              	INC	EAX
   423 000004F9 80 38 20                        	CMP	BYTE [EAX],32
   424 000004FC 74 FA                           	JE	L122
   425 000004FE EB F6                           	JMP	L124
   426 00000500                                 	GLOBAL	_textview
   427 00000500                                 _textview:
   428 00000500 55                              	PUSH	EBP
   429 00000501 89 E5                           	MOV	EBP,ESP
   430 00000503 57                              	PUSH	EDI
   431 00000504 56                              	PUSH	ESI
   432 00000505 53                              	PUSH	EBX
   433 00000506 83 EC 18                        	SUB	ESP,24
   434 00000509 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   435 0000050C 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   436 0000050F 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   437 00000512 8B 75 10                        	MOV	ESI,DWORD [16+EBP]
   438 00000515 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   439 00000518 89 55 EC                        	MOV	DWORD [-20+EBP],EDX
   440 0000051B 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
   441 0000051E 8B 55 18                        	MOV	EDX,DWORD [24+EBP]
   442 00000521 8B 45 1C                        	MOV	EAX,DWORD [28+EBP]
   443 00000524 89 55 E4                        	MOV	DWORD [-28+EBP],EDX
   444 00000527 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   445 0000052A 8B 55 20                        	MOV	EDX,DWORD [32+EBP]
   446 0000052D 89 F0                           	MOV	EAX,ESI
   447 0000052F 89 55 DC                        	MOV	DWORD [-36+EBP],EDX
   448 00000532 C1 E0 04                        	SAL	EAX,4
   449 00000535 6A 07                           	PUSH	7
   450 00000537 83 C0 1C                        	ADD	EAX,28
   451 0000053A 50                              	PUSH	EAX
   452 0000053B 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   453 0000053E 8D 04 D5 00000007               	LEA	EAX,DWORD [7+EDX*8]
   454 00000545 50                              	PUSH	EAX
   455 00000546 6A 1D                           	PUSH	29
   456 00000548 6A 08                           	PUSH	8
   457 0000054A 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   458 0000054D 40                              	INC	EAX
   459 0000054E 50                              	PUSH	EAX
   460 0000054F E8 [00000000]                   	CALL	_api_boxfilwin
   461 00000554 83 C4 18                        	ADD	ESP,24
   462 00000557 85 F6                           	TEST	ESI,ESI
   463 00000559 7E 2B                           	JLE	L132
   464 0000055B BF 0000001D                     	MOV	EDI,29
   465 00000560 89 F3                           	MOV	EBX,ESI
   466 00000562                                 L130:
   467 00000562 FF 75 DC                        	PUSH	DWORD [-36+EBP]
   468 00000565 FF 75 E0                        	PUSH	DWORD [-32+EBP]
   469 00000568 FF 75 E4                        	PUSH	DWORD [-28+EBP]
   470 0000056B FF 75 E8                        	PUSH	DWORD [-24+EBP]
   471 0000056E 57                              	PUSH	EDI
   472 0000056F 83 C7 10                        	ADD	EDI,16
   473 00000572 FF 75 EC                        	PUSH	DWORD [-20+EBP]
   474 00000575 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   475 00000578 E8 0000003F                     	CALL	_lineview
   476 0000057D 83 C4 1C                        	ADD	ESP,28
   477 00000580 4B                              	DEC	EBX
   478 00000581 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   479 00000584 75 DC                           	JNE	L130
   480 00000586                                 L132:
   481 00000586 C1 E6 04                        	SAL	ESI,4
   482 00000589 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   483 0000058C C7 45 10 0000001D               	MOV	DWORD [16+EBP],29
   484 00000593 8D 46 1D                        	LEA	EAX,DWORD [29+ESI]
   485 00000596 89 45 18                        	MOV	DWORD [24+EBP],EAX
   486 00000599 8D 04 D5 00000008               	LEA	EAX,DWORD [8+EDX*8]
   487 000005A0 89 45 14                        	MOV	DWORD [20+EBP],EAX
   488 000005A3 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   489 000005A6 C7 45 0C 00000008               	MOV	DWORD [12+EBP],8
   490 000005AD 89 45 08                        	MOV	DWORD [8+EBP],EAX
   491 000005B0 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   492 000005B3 5B                              	POP	EBX
   493 000005B4 5E                              	POP	ESI
   494 000005B5 5F                              	POP	EDI
   495 000005B6 5D                              	POP	EBP
   496 000005B7 E9 [00000000]                   	JMP	_api_refreshwin
   497 000005BC                                 	GLOBAL	_lineview
   498 000005BC                                 _lineview:
   499 000005BC 55                              	PUSH	EBP
   500 000005BD 89 E5                           	MOV	EBP,ESP
   501 000005BF 57                              	PUSH	EDI
   502 000005C0 56                              	PUSH	ESI
   503 000005C1 53                              	PUSH	EBX
   504 000005C2 81 EC 00000090                  	SUB	ESP,144
   505 000005C8 8B 7D 14                        	MOV	EDI,DWORD [20+EBP]
   506 000005CB 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   507 000005CE 89 FA                           	MOV	EDX,EDI
   508 000005D0 8B 5D 18                        	MOV	EBX,DWORD [24+EBP]
   509 000005D3 F7 DA                           	NEG	EDX
   510 000005D5                                 L134:
   511 000005D5 8A 03                           	MOV	AL,BYTE [EBX]
   512 000005D7 84 C0                           	TEST	AL,AL
   513 000005D9 0F 84 00000166                  	JE	L135
   514 000005DF 3C 0A                           	CMP	AL,10
   515 000005E1 0F 84 0000015D                  	JE	L164
   516 000005E7 83 7D 20 00                     	CMP	DWORD [32+EBP],0
   517 000005EB 75 19                           	JNE	L139
   518 000005ED 3C 09                           	CMP	AL,9
   519 000005EF 0F 84 00000133                  	JE	L165
   520 000005F5 85 D2                           	TEST	EDX,EDX
   521 000005F7 78 0B                           	JS	L142
   522 000005F9 39 F2                           	CMP	EDX,ESI
   523 000005FB 7D 07                           	JGE	L142
   524 000005FD 88 84 15 FFFFFF64               	MOV	BYTE [-156+EBP+EDX*1],AL
   525 00000604                                 L142:
   526 00000604 42                              	INC	EDX
   527 00000605                                 L141:
   528 00000605 43                              	INC	EBX
   529 00000606                                 L139:
   530 00000606 83 7D 20 01                     	CMP	DWORD [32+EBP],1
   531 0000060A 0F 84 0000008A                  	JE	L166
   532 00000610                                 L143:
   533 00000610 83 7D 20 02                     	CMP	DWORD [32+EBP],2
   534 00000614 75 BF                           	JNE	L134
   535 00000616 8A 0B                           	MOV	CL,BYTE [EBX]
   536 00000618 80 F9 09                        	CMP	CL,9
   537 0000061B 74 60                           	JE	L167
   538 0000061D 8D 41 5F                        	LEA	EAX,DWORD [95+ECX]
   539 00000620 3C 5D                           	CMP	AL,93
   540 00000622 76 13                           	JBE	L168
   541 00000624 85 D2                           	TEST	EDX,EDX
   542 00000626 78 0B                           	JS	L161
   543 00000628 39 F2                           	CMP	EDX,ESI
   544 0000062A 7D 07                           	JGE	L161
   545 0000062C 88 8C 15 FFFFFF64               	MOV	BYTE [-156+EBP+EDX*1],CL
   546 00000633                                 L161:
   547 00000633 42                              	INC	EDX
   548 00000634 43                              	INC	EBX
   549 00000635 EB 9E                           	JMP	L134
   550 00000637                                 L168:
   551 00000637 83 FA FF                        	CMP	EDX,-1
   552 0000063A 74 38                           	JE	L169
   553 0000063C                                 L157:
   554 0000063C 85 D2                           	TEST	EDX,EDX
   555 0000063E 78 18                           	JS	L158
   556 00000640 8D 46 FF                        	LEA	EAX,DWORD [-1+ESI]
   557 00000643 39 C2                           	CMP	EDX,EAX
   558 00000645 7D 11                           	JGE	L158
   559 00000647 88 8C 15 FFFFFF64               	MOV	BYTE [-156+EBP+EDX*1],CL
   560 0000064E 8A 43 01                        	MOV	AL,BYTE [1+EBX]
   561 00000651 88 84 15 FFFFFF65               	MOV	BYTE [-155+EBP+EDX*1],AL
   562 00000658                                 L158:
   563 00000658 8D 46 FF                        	LEA	EAX,DWORD [-1+ESI]
   564 0000065B 39 C2                           	CMP	EDX,EAX
   565 0000065D 74 0B                           	JE	L170
   566 0000065F                                 L159:
   567 0000065F 83 C2 02                        	ADD	EDX,2
   568 00000662 83 C3 02                        	ADD	EBX,2
   569 00000665 E9 FFFFFF6B                     	JMP	L134
   570 0000066A                                 L170:
   571 0000066A C6 84 15 FFFFFF64 20            	MOV	BYTE [-156+EBP+EDX*1],32
   572 00000672 EB EB                           	JMP	L159
   573 00000674                                 L169:
   574 00000674 C6 85 FFFFFF64 20               	MOV	BYTE [-156+EBP],32
   575 0000067B EB BF                           	JMP	L157
   576 0000067D                                 L167:
   577 0000067D FF 75 1C                        	PUSH	DWORD [28+EBP]
   578 00000680 8D 85 FFFFFF64                  	LEA	EAX,DWORD [-156+EBP]
   579 00000686 43                              	INC	EBX
   580 00000687 50                              	PUSH	EAX
   581 00000688 57                              	PUSH	EDI
   582 00000689 56                              	PUSH	ESI
   583 0000068A 52                              	PUSH	EDX
   584 0000068B E8 000000ED                     	CALL	_puttab
   585 00000690 83 C4 14                        	ADD	ESP,20
   586 00000693 89 C2                           	MOV	EDX,EAX
   587 00000695 E9 FFFFFF3B                     	JMP	L134
   588 0000069A                                 L166:
   589 0000069A 8A 0B                           	MOV	CL,BYTE [EBX]
   590 0000069C 80 F9 09                        	CMP	CL,9
   591 0000069F 74 6A                           	JE	L171
   592 000006A1 8D 41 7F                        	LEA	EAX,DWORD [127+ECX]
   593 000006A4 3C 1E                           	CMP	AL,30
   594 000006A6 76 07                           	JBE	L147
   595 000006A8 8D 41 20                        	LEA	EAX,DWORD [32+ECX]
   596 000006AB 3C 1C                           	CMP	AL,28
   597 000006AD 77 46                           	JA	L146
   598 000006AF                                 L147:
   599 000006AF 83 FA FF                        	CMP	EDX,-1
   600 000006B2 74 38                           	JE	L172
   601 000006B4                                 L148:
   602 000006B4 85 D2                           	TEST	EDX,EDX
   603 000006B6 78 18                           	JS	L149
   604 000006B8 8D 46 FF                        	LEA	EAX,DWORD [-1+ESI]
   605 000006BB 39 C2                           	CMP	EDX,EAX
   606 000006BD 7D 11                           	JGE	L149
   607 000006BF 88 8C 15 FFFFFF64               	MOV	BYTE [-156+EBP+EDX*1],CL
   608 000006C6 8A 43 01                        	MOV	AL,BYTE [1+EBX]
   609 000006C9 88 84 15 FFFFFF65               	MOV	BYTE [-155+EBP+EDX*1],AL
   610 000006D0                                 L149:
   611 000006D0 8D 46 FF                        	LEA	EAX,DWORD [-1+ESI]
   612 000006D3 39 C2                           	CMP	EDX,EAX
   613 000006D5 74 0B                           	JE	L173
   614 000006D7                                 L150:
   615 000006D7 83 C2 02                        	ADD	EDX,2
   616 000006DA 83 C3 02                        	ADD	EBX,2
   617 000006DD E9 FFFFFF2E                     	JMP	L143
   618 000006E2                                 L173:
   619 000006E2 C6 84 15 FFFFFF64 20            	MOV	BYTE [-156+EBP+EDX*1],32
   620 000006EA EB EB                           	JMP	L150
   621 000006EC                                 L172:
   622 000006EC C6 85 FFFFFF64 20               	MOV	BYTE [-156+EBP],32
   623 000006F3 EB BF                           	JMP	L148
   624 000006F5                                 L146:
   625 000006F5 85 D2                           	TEST	EDX,EDX
   626 000006F7 78 0B                           	JS	L152
   627 000006F9 39 F2                           	CMP	EDX,ESI
   628 000006FB 7D 07                           	JGE	L152
   629 000006FD 88 8C 15 FFFFFF64               	MOV	BYTE [-156+EBP+EDX*1],CL
   630 00000704                                 L152:
   631 00000704 42                              	INC	EDX
   632 00000705 43                              	INC	EBX
   633 00000706 E9 FFFFFF05                     	JMP	L143
   634 0000070B                                 L171:
   635 0000070B FF 75 1C                        	PUSH	DWORD [28+EBP]
   636 0000070E 8D 85 FFFFFF64                  	LEA	EAX,DWORD [-156+EBP]
   637 00000714 43                              	INC	EBX
   638 00000715 50                              	PUSH	EAX
   639 00000716 57                              	PUSH	EDI
   640 00000717 56                              	PUSH	ESI
   641 00000718 52                              	PUSH	EDX
   642 00000719 E8 0000005F                     	CALL	_puttab
   643 0000071E 83 C4 14                        	ADD	ESP,20
   644 00000721 89 C2                           	MOV	EDX,EAX
   645 00000723 E9 FFFFFEE8                     	JMP	L143
   646 00000728                                 L165:
   647 00000728 FF 75 1C                        	PUSH	DWORD [28+EBP]
   648 0000072B 8D 85 FFFFFF64                  	LEA	EAX,DWORD [-156+EBP]
   649 00000731 50                              	PUSH	EAX
   650 00000732 57                              	PUSH	EDI
   651 00000733 56                              	PUSH	ESI
   652 00000734 52                              	PUSH	EDX
   653 00000735 E8 00000043                     	CALL	_puttab
   654 0000073A 83 C4 14                        	ADD	ESP,20
   655 0000073D 89 C2                           	MOV	EDX,EAX
   656 0000073F E9 FFFFFEC1                     	JMP	L141
   657 00000744                                 L164:
   658 00000744 43                              	INC	EBX
   659 00000745                                 L135:
   660 00000745 39 F2                           	CMP	EDX,ESI
   661 00000747 7E 02                           	JLE	L162
   662 00000749 89 F2                           	MOV	EDX,ESI
   663 0000074B                                 L162:
   664 0000074B 85 D2                           	TEST	EDX,EDX
   665 0000074D 7E 24                           	JLE	L163
   666 0000074F 8D 85 FFFFFF64                  	LEA	EAX,DWORD [-156+EBP]
   667 00000755 50                              	PUSH	EAX
   668 00000756 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   669 00000759 52                              	PUSH	EDX
   670 0000075A 40                              	INC	EAX
   671 0000075B 6A 00                           	PUSH	0
   672 0000075D FF 75 10                        	PUSH	DWORD [16+EBP]
   673 00000760 6A 08                           	PUSH	8
   674 00000762 50                              	PUSH	EAX
   675 00000763 C6 84 15 FFFFFF64 00            	MOV	BYTE [-156+EBP+EDX*1],0
   676 0000076B E8 [00000000]                   	CALL	_api_putstrwin
   677 00000770 83 C4 18                        	ADD	ESP,24
   678 00000773                                 L163:
   679 00000773 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   680 00000776 89 D8                           	MOV	EAX,EBX
   681 00000778 5B                              	POP	EBX
   682 00000779 5E                              	POP	ESI
   683 0000077A 5F                              	POP	EDI
   684 0000077B 5D                              	POP	EBP
   685 0000077C C3                              	RET
   686 0000077D                                 	GLOBAL	_puttab
   687 0000077D                                 _puttab:
   688 0000077D 55                              	PUSH	EBP
   689 0000077E 89 E5                           	MOV	EBP,ESP
   690 00000780 57                              	PUSH	EDI
   691 00000781 56                              	PUSH	ESI
   692 00000782 53                              	PUSH	EBX
   693 00000783 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   694 00000786 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
   695 00000789 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   696 0000078C 8B 5D 18                        	MOV	EBX,DWORD [24+EBP]
   697 0000078F                                 L175:
   698 0000078F 85 C9                           	TEST	ECX,ECX
   699 00000791 78 09                           	JS	L178
   700 00000793 3B 4D 0C                        	CMP	ECX,DWORD [12+EBP]
   701 00000796 7D 04                           	JGE	L178
   702 00000798 C6 04 31 20                     	MOV	BYTE [ECX+ESI*1],32
   703 0000079C                                 L178:
   704 0000079C 41                              	INC	ECX
   705 0000079D 8D 04 0F                        	LEA	EAX,DWORD [EDI+ECX*1]
   706 000007A0 99                              	CDQ
   707 000007A1 F7 FB                           	IDIV	EBX
   708 000007A3 85 D2                           	TEST	EDX,EDX
   709 000007A5 75 E8                           	JNE	L175
   710 000007A7 5B                              	POP	EBX
   711 000007A8 89 C8                           	MOV	EAX,ECX
   712 000007AA 5E                              	POP	ESI
   713 000007AB 5F                              	POP	EDI
   714 000007AC 5D                              	POP	EBP
   715 000007AD C3                              	RET
